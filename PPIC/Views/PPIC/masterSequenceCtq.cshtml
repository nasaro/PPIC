<style>
    .loader {
        position: fixed;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: url('/Content/Images/pageLoader.gif') 50% 50% no-repeat rgb(249,249,249);
        opacity: .8;
    }

    .cart {
        height: 300px;
        padding: 10px;
        border: solid 0.5px silver;
    }

     .cart-tbl {
        height: 280px;
        border-radius: 10px;
        background: #e3f2e4;
        overflow: auto;
     }

     .nav-tabs
     {
       border-color:#1A3E5E;
       width:90%;
     }

    .nav-tabs > li a { 
        border: 1px solid #1A3E5E;
        background-color:#2F71AB; 
        color:#fff;
        }

    .nav-tabs > li.active > a,
    .nav-tabs > li.active > a:focus,
    .nav-tabs > li.active > a:hover{
        background-color:#D6E6F3;
        color:#000;
        border: 1px solid #1A3E5E;
        border-bottom-color: transparent;
        }

    .nav-tabs > li > a:hover{
      background-color: #D6E6F3 !important;
        border-radius: 5px;
        color:#000;

    } 

    .tab-pane {
        border:solid 1px #1A3E5E;
        border-top: 0; 
        width:90%;
        background-color:#D6E6F3;
        padding:5px;

    }

    .gtext {
        color: blue;
        text-shadow: 2px 2px 5px blue;
        font-size: 100%;
    }
</style>

@{
    ViewBag.Title = "Master Sequential Ctq";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            Dashboard
            <small>Master Sequential Ctq</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
            <li class="active">Dashboard</li>
        </ol>
    </section>
    <!-- Main content -->
    <section class="content">
        <div class="row">
            <div class="col-xs-12">
                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title">Machining Product</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div id="mainform" class="form-horizontal">
                            <table id="product" class="table table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th bgcolor='#aa80ff' style='color:black'>ID</th>
                                        <th bgcolor='#aa80ff' style='color:black'>Product</th>
                                        <th bgcolor='#aa80ff' style='color:black'><span class='pull-right'>CNC Time</span></th>
                                        <th bgcolor='#aa80ff' style='color:black'><span class='pull-right'>Manual Time</span></th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        <br />
                        <div class="row">
                            <!-- id  and name product -->
                            <div class="col-md-2">
                                <label> Name Product : </label>
                                <input type="hidden" class="form-control" id="idprod" disabled="disabled" />
                            </div>
                            <div class="col-md-7">
                                <strong><input type="text" class="form-control" id="nameprod" disabled="disabled" style="color:crimson" /></strong>
                            </div>
                        </div>

                            <form>
                                <div class="container">
                                    <ul class="nav nav-tabs">
                                        <li class="active"><a href="#Ctq1"><strong>Sequence Process</strong></a></li>
                                        <li><a href="#Ctq2"><strong>CTQ</strong></a></li>
                                    </ul>
                                    <div class="tab-content">
                                        <div id="Ctq1" class="tab-pane fade in active">
                                            <div class="row">
                                                <div class="col-md-2">
                                                    <h5><button type="button" class="btn btn-danger btn-block btn-sm" data-toggle="modal" onclick="AddHeader();"><strong>Add Header</strong></button></h5>
                                                </div>
                                                <div class="col-md-1">
                                                    <label>CopyID</label>
                                                </div>
                                               <div class="col-md-2">
                                                    <strong><input type="text" class="form-control" id="copyData" disabled="disabled" style="color:crimson" /></strong>
                                                </div>
                                                <div class="col-md-1">
                                                    <label>PasteID</label>
                                                </div>
                                                <div class="col-md-2">
                                                    <strong><input type="text" class="form-control" id="pasteData" disabled="disabled" style="color:crimson" /></strong>
                                                </div>
                                                <div class="col-md-2">
                                                    <h5><button type="button" class="btn btn-success btn-block btn-sm" data-toggle="modal" onclick="GenerateDetail();"><strong>Generate...</strong><span class="glyphicon glyphicon-duplicate"></span></button></h5>
                                                </div>
                                            </div>
                                            <div class="cart">
                                                <div class="cart-tbl">
                                                    <table id="HeadInfo" class="table table-bordered  table-hover">
                                                        <thead>
                                                            <tr>
                                                                <th bgcolor='#ff99ff' style='color:black'>No</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>Remark</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>MachiningType</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>Chuck Size</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>RPM</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>Run/Out</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>TackTime</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>HandlingTime</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>Edit</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>Delete</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>Copy</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>Paste</th>
                                                                <th bgcolor='#ff99ff' style='color:black'>Details</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="tbodyHeadInfo"></tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div><!--End Content for child-->
                                        <div id="Ctq2" class="tab-pane fade">
                                            <div class="row">
                                                <div class="col-md-2">
                                                    <h5><button type="button" class="btn btn-success btn-block btn-sm" data-toggle="modal" onclick="AddDetail();"><strong>Add Detail</strong></button></h5>                                                    
                                                </div>
                                                <div class="col-md-12">
                                                    <h5 class="modal-title" id="DetailLabel1"></h5>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <h5 class="modal-title" id="DetailLabel2"></h5>
                                                </div>
                                                <div class="col-md-6">
                                                    <h5 class="modal-title" id="DetailLabel3"></h5>
                                                </div>
                                            </div>
                                            <div class="cart">
                                                <div class="cart-tbl">
                                                    <table id="DetailInfo" class="table table-bordered  table-hover">
                                                        <thead>
                                                            <tr>
                                                                <th bgcolor='#66ffcc' style='color:black'>No</th>
                                                                <th bgcolor='#66ffcc' style='color:black'><span class='pull-right'>Dim Abs</span></th>
                                                                <th bgcolor='#66ffcc' style='color:black'><span class='pull-right'>Upper Dim</span></th>
                                                                <th bgcolor='#66ffcc' style='color:black'><span class='pull-right'>Lower Dim</span></th>
                                                                <th bgcolor='#66ffcc' style='color:black'>Tools</th>
                                                                <th bgcolor='#66ffcc' style='color:black'>Remark</th>
                                                                <th bgcolor='#66ffcc' style='color:black'><span class='pull-right'>Interval Check</span></th>
                                                                <th bgcolor='#66ffcc' style='color:black'>Edit</th>
                                                                <th bgcolor='#66ffcc' style='color:black'>Delete</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="tbodyDetailInfo"></tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div><!--End Of Tab Contents-->
                                </div><!--End Of Container-->
                              </form>
                        </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
            </div>
            <!-- /.col -->
        </div>
        <!-- /.row -->
        <div class="modal fade" id="myModalAddHeader" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header alert-danger">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title" id="myModalLabel1">Add Header</h4>
                        <h5 class="modal-title" id="myModalLabel2"></h5>                        
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="row">
                                <div class="col-sm-3">
                                    <label>Remark :</label>
                                </div>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="remH" placeholder="Please Remark" />
                                    <input type="hidden" class="form-control" id="idseq" />
                                    <input type="hidden" class="form-control" id="idctq" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <label for="machineType">Machine Type:</label>
                                </div>
                                <div class="col-sm-9">
                                    <select class="form-control" id="machineType">
                                        <option value="Turning">Turning</option>
                                        <option value="Milling">Milling</option>
                                        <option value="Turning/Milling">Turning/Milling</option>
                                        <option value="Swiss">Swiss Type Lathe</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <label>Chuck Size :</label>
                                </div>
                                <div class="col-sm-9">
                                    <input type="number" class="form-control" id="chuck" placeholder="Please chuck size" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <label>RPM :</label>
                                </div>
                                <div class="col-sm-9">
                                    <input type="number" class="form-control" id="rpm" placeholder="Please RPM" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <label>Run/Out :</label>
                                </div>
                                <div class="col-sm-9">
                                    <input type="number" class="form-control" id="rout" placeholder="Please Run/Out" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <label>TackTime :</label>
                                </div>
                                <div class="col-sm-9">
                                    <input type="number" class="form-control" id="tack" placeholder="Please Tack Time" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3">
                                    <label>HandlingTime :</label>
                                </div>
                                <div class="col-sm-9">
                                    <input type="number" class="form-control" id="hand" placeholder="Please Tack Time" />
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="btnAddHdr" data-dismiss="modal" onclick="addHeaderModal();">Save</button>
                        <button type="button" class="btn btn-primary" id="btnUpdateHdr" style="display:none;" onclick="editHeaderModal();">Update</button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>  <!-- /.myModalAddHeader -->

        <div class="modal fade" id="myModalAddDetail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header alert-danger">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title" id="myModalLabel3">Add Details</h4>
                        <h5 class="modal-title" id="myModalLabel4"></h5>
                        <h5 class="modal-title" id="myModalLabel5"></h5>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="row">
                                <div class="col-sm-4">
                                    <label>Dim ABS :</label>
                                </div>
                                <div class="col-sm-8">
                                    <input type="number" class="form-control" id="dimabs" placeholder="Dim ABS" />
                                    <input type="hidden" class="form-control" id="idctqH" />
                                    <input type="hidden" class="form-control" id="idseqH" />
                                    <input type="hidden" class="form-control" id="idseqD" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <label>Upper Dim :</label>
                                </div>
                                <div class="col-sm-8">
                                    <input type="number" class="form-control" id="upperD" placeholder="Upper Dim" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <label>Lower Dim :</label>
                                </div>
                                <div class="col-sm-8">
                                    <input type="number" class="form-control" id="lowerD" placeholder="Lower Dim" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <label>Tools :</label>
                                </div>
                                <div class="col-sm-8">
                                    <select class="form-control" id="cbtools"  placeholder="Measure Tools"></select>
                                </div>
                            </div>
                           <div class="row">
                                <div class="col-sm-4">
                                    <label>Remark :</label>
                                </div>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="remD" placeholder="Please Remark" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <label>Interval Check :</label>
                                </div>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="interval" placeholder="Please Interval Check" />
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="btnAddDtl" data-dismiss="modal" onclick="addDetailModal();">Save</button>
                        <button type="button" class="btn btn-primary" id="btnUpdateDtl" style="display:none;" onclick="editDetailModal();">Update</button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>  <!-- /.myModalAddDetail -->

    </section>
    <!-- /.content -->

</div>
<div class="loader"></div>

@section Scripts
{
    <script>
        var urlPPIC = "@Url.Content("~/PPIC")";
        $(document).ready(function () {
            $('#mydateDelivery').datepicker({
                format: "dd-mm-yyyy"
            });
            loadTool();
            MainLoad();
            $('.nav-tabs a').click(function () {
                $(this).tab('show');
            })

        })

        function MainLoad() {
            var tr;
            $.ajax({
                url: urlPPIC + "/ViewMachining/",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                beforeSend: function () { $(".loader").show(); },
                complete: function () { $(".loader").hide(); },
                dataType: "json",
                success: function (result) {
                    $.each(result, function (key, item) {
                        tr = $('<tr/>');
                        tr.append("<td>" + item.Id + "</td>");
                        tr.append('<td class="gtext" >' + item.ProductName + "</td>");
                        tr.append("<td><span class='pull-right'>" + formatNumber(item.cncTime) + "</span></td>");
                        tr.append("<td><span class='pull-right'>" + formatNumber(item.manualTime) + "</span></td>");
                        $('#product').append(tr);
                    });

                    var masterTable = $('#product').DataTable({
                        "columnDefs": [
                            {
                                "targets": [0],
                                "visible": false,
                                "searchable": false
                            }
                        ]
                    });
                    $('#product tbody').on('click', 'tr', function () {
                        var data = masterTable.row(this).data();
                        viewSequence(data[0], data[1]);
                    });

                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
        }

        function viewSequence(id, name) {
            //-----blank generate
            $('#copyData').val('');
            $('#pasteData').val('');

            $('#tbodyDetailInfo').empty();
            $('#DetailLabel2').text('Remark  : ');
            $('#DetailLabel3').text('Row Hdr : ');

            $('#idprod').val(id);
            $('#nameprod').val(name);
            HeadLoad(id);
        }

        function HeadLoad(ID) {
            var tr;
            var j = 1;
            $('#tbodyHeadInfo').empty();
            $.ajax({
                url: urlPPIC + "/ViewHeadSeq/"+ID,
                type: "POST",
                contentType: "application/json;charset=utf-8",
                beforeSend: function () { $(".loader").show(); },
                complete: function () { $(".loader").hide(); },
                dataType: "json",
                success: function (result) {
                    $.each(result, function (key, item) {
                        tr = $('<tr/>');
                        tr.append("<td>" + j + "</td>");
                        tr.append("<td>" + item.remarkH + "</td>");
                        if (item.machineType==='Swiss')
                            tr.append("<td>Swiss Type Lathe</td>");
                        else 
                            tr.append("<td>" + item.machineType + "</td>");
                        tr.append("<td>" + item.dimabs + "</td>");
                        tr.append("<td>" + item.upperdim + "</td>");
                        tr.append("<td>" + item.lowerdim + "</td>");
                        tr.append("<td>" + item.tacktime + "</td>");
                        tr.append("<td>" + item.handlingtime + "</td>");
                        tr.append('<td><a href="javascript:void(0)" data-toggle="tooltip" title="Edit !" onclick="getHeader(' + item.dimabs + ',' + item.upperdim + ',' + item.lowerdim + ',' + item.idCtq1 + ',' + item.Id + ',' + item.IdSeqH + ',' + item.tacktime + ',' + item.handlingtime + ',\'' + item.remarkH + '\',\'' + item.machineType + '\')"><span class="glyphicon glyphicon-pencil"></span></a></td>');
                        tr.append('<td><a href="javascript:void(0)"  data-toggle="tooltip" title="Delete !" onclick="delHeader(' + item.idCtq1 + ',' + item.Id + ',' + item.IdSeqH + ')"><span class="glyphicon glyphicon-trash"></span></a></td>');
                        tr.append('<td><a href="javascript:void(0)"  data-toggle="tooltip" title="Copy !" onclick="copyHeader(' + item.idCtq1 + ', 1' +')"><span class="glyphicon glyphicon-copy"></span></a></td>');
                        tr.append('<td><a href="javascript:void(0)"  data-toggle="tooltip" title="Paste !" onclick="copyHeader(' + item.idCtq1 + ', 2' + ')"><span class="glyphicon glyphicon-paste"></span></a></td>');
                        tr.append('<td><a href="javascript:void(0)"  data-toggle="tooltip" title="Details !" onclick="detailsHeader(' + item.dimabs + ',' + item.upperdim + ',' + item.lowerdim + ',' + item.idCtq1 + ',' + item.Id + ',' + item.IdSeqH + ',\'' + item.remarkH + '\',\'' + item.machineType + '\')"><span class="glyphicon glyphicon-th-list"></span></a></td>');
                        $('#HeadInfo').append(tr);
                        j++;
                    });
                    //$('#HeadInfo').DataTable();
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
        }

        function copyHeader(dt1, dt2) {
            if (dt2 === 1)
                $('#copyData').val(dt1);
            else $('#pasteData').val(dt1);
        }

        function GenerateDetail() {
            var res = validateGenerate();
            if (res == false) {
                return false;
            }
           
            var empObj = {
                id1: $('#copyData').val(),
                Id2: $('#pasteData').val()
            };
            $.ajax({
                url: urlPPIC + "/vGenerate",
                data: JSON.stringify(empObj),
                type: "POST",
                contentType: "application/json;charset=utf-8",
                beforeSend: function () { $(".loader").show(); },
                complete: function () { $(".loader").hide(); },
                dataType: "json",
                success: function (result) {
                    BootstrapAlert.success({
                        title: "Message",
                        message: "Succesfuly Generate..."
                    });
                    $('#copyData').val('');
                    $('#pasteData').val('');
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
            
        }


        function validateGenerate() {
            var isValid = true;
            if ($('#copyData').val().trim() == "") {
                $('#copyData').css('border-color', 'Red');
                isValid = false;
            }
            else {
                $('#copyData').css('border-color', 'lightgrey');
            }

            if ($('#pasteData').val().trim() == "") {
                $('#pasteData').css('border-color', 'Red');
                isValid = false;
            }
            else {
                $('#pasteData').css('border-color', 'lightgrey');
            }

            return isValid;
        }

        function AddHeader() {
            $('#myModalAddHeader').modal('show');
            $('#myModalLabel1').text('Add Header');
            $('#myModalLabel2').text($('#nameprod').val());
            $('#remH').val('');
            $('#tack').val('');
            $('#hand').val('');
            $('#chuck').val('');
            $('#rpm').val('');
            $('#rout').val('');
            //-----blank generate
            $('#copyData').val('');
            $('#pasteData').val('');

            $('#btnAddHdr').show();
            $('#btnUpdateHdr').hide();
        }

        function getHeader(chuck, rpm, runout, idctq, idprd, headseq, tack, hand, rem, machinetype) {
            $('#myModalAddHeader').modal('show');
            $('#myModalLabel1').text('Update Header');
            $('#myModalLabel2').text($('#nameprod').val());            
            $('#idctq').val(idctq);
            $('#idseq').val(headseq);
            $('#remH').val(rem);           
            $('#machineType').val(machinetype);
            $('#chuck').val(chuck);
            $('#rpm').val(rpm);
            $('#rout').val(runout);
            $('#tack').val(tack);
            $('#hand').val(hand);

            //-----blank generate
            $('#copyData').val('');
            $('#pasteData').val('');

            $('#btnUpdateHdr').show();
            $('#btnAddHdr').hide();
        }


        function delHeader(idctq, id, head) {
            //-----blank generate
            $('#copyData').val('');
            $('#pasteData').val('');

            var ans = confirm("Are you sure you want to delete this Record?");
            if (ans) {
                var empObj = {
                    idCtq1: idctq, 
                    Id: id,
                    IdSeqH: head
                };
                $.ajax({
                    url: urlPPIC + "/DelseqHDR",
                    data: JSON.stringify(empObj),
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    beforeSend: function () { $(".loader").show(); },
                    complete: function () { $(".loader").hide(); },
                    dataType: "json",
                    success: function (result) {
                        loadDataRefresh();
                    },
                    error: function (errormessage) {
                        alert(errormessage.responseText);
                    }
                });
            }

        }

        function addHeaderModal() {
            var empObj = {
                Id: $('#idprod').val(),
                remarkH: $('#remH').val(),
                tacktime: $('#tack').val(),
                handlingtime: $('#hand').val(),
                machineType: $('#machineType').val(),
                dimabs: $('#chuck').val(),
                upperdim: $('#rpm').val(),
                lowerdim: $('#rout').val()
            };
            $.ajax({
                url: urlPPIC + "/InsertSeqHeader",
                data: JSON.stringify(empObj),
                type: "POST",
                contentType: "application/json;charset=utf-8",
                beforeSend: function () { $(".loader").show(); },
                complete: function () { $(".loader").hide(); },
                dataType: "json",
                success: function (result) {
                    loadDataRefresh();
                    $('#myModalAddHeader').modal('hide');
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
        }

        function editHeaderModal() {
            var empObj = {
                idCtq1: $('#idctq').val(),
                Id: $('#idprod').val(),
                IdSeqH: $('#idseq').val(),
                remarkH: $('#remH').val(),
                machineType: $('#machineType').val(),
                tacktime: $('#tack').val(),
                handlingtime: $('#hand').val(),
                dimabs: $('#chuck').val(),
                upperdim: $('#rpm').val(),
                lowerdim: $('#rout').val()


            };
            $.ajax({
                url: urlPPIC + "/UpdateseqHDR",
                data: JSON.stringify(empObj),
                type: "POST",
                contentType: "application/json;charset=utf-8",
                beforeSend: function () { $(".loader").show(); },
                complete: function () { $(".loader").hide(); },
                dataType: "json",
                success: function (result) {
                    $('#myModalAddHeader').modal('hide');
                    loadDataRefresh();
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
        }

        function loadDataRefresh() {
            var ID = $('#idprod').val();
            $('#tbodyHeadInfo').empty();
            $.getJSON(urlPPIC + "/ViewHeadSeq/" + ID,
            function (json) {
                var tr;
                var j=1;
                for (var i = 0; i < json.length; i++) {
                    tr = $('<tr/>');
                    tr.append("<td>" + j + "</td>");
                    tr.append("<td>" + json[i].remarkH + "</td>");
                    if (json[i].machineType === 'Swiss')
                        tr.append("<td>Swiss Type Lathe</td>");
                    else
                        tr.append("<td>" + json[i].machineType + "</td>");
                    tr.append("<td>" + json[i].dimabs + "</td>");
                    tr.append("<td>" + json[i].upperdim + "</td>");
                    tr.append("<td>" + json[i].lowerdim + "</td>");

                    tr.append("<td>" + json[i].tacktime + "</td>");
                    tr.append("<td>" + json[i].handlingtime + "</td>");
                    tr.append('<td><a href="javascript:void(0)" data-toggle="tooltip" title="Edit !" onclick="getHeader(' + json[i].dimabs + ',' + json[i].upperdim + ',' + json[i].lowerdim + ',' + json[i].idCtq1 + ',' + json[i].Id + ',' + json[i].IdSeqH + ',' + json[i].tacktime + ',' + json[i].handlingtime + ',\'' + json[i].remarkH + '\',\'' + json[i].machineType + '\')"><span class="glyphicon glyphicon-pencil"></span></a></td>');
                    tr.append('<td><a href="javascript:void(0)"  data-toggle="tooltip" title="Delete !" onclick="delHeader(' + json[i].idCtq1 + ','+ json[i].Id + ',' + json[i].IdSeqH + ')"><span class="glyphicon glyphicon-trash"></span></a></td>');
                    tr.append('<td><a href="javascript:void(0)"  data-toggle="tooltip" title="Copy !" onclick="copyHeader(' + json[i].idCtq1 + ', 1' + ')"><span class="glyphicon glyphicon-copy"></span></a></td>');
                    tr.append('<td><a href="javascript:void(0)"  data-toggle="tooltip" title="Paste !" onclick="copyHeader(' + json[i].idCtq1 + ', 2' + ')"><span class="glyphicon glyphicon-paste"></span></a></td>');
                    tr.append('<td><a href="javascript:void(0)"  data-toggle="tooltip" title="Details !" onclick="detailsHeader(' + json[i].dimabs + ',' + json[i].upperdim + ',' + json[i].lowerdim + ',' + json[i].idCtq1 + ',' + json[i].Id + ',' + json[i].IdSeqH + ',\'' + json[i].remarkH + '\',\'' + json[i].machineType + '\')"><span class="glyphicon glyphicon-th-list"></span></a></td>');
                    $('#HeadInfo').append(tr);
                    j++;
                }
            });
        }
        function detailsHeader(chuck, rpm, runout, idctq, id, head, rem, type) {

            $('.nav-tabs li:eq(1) a').tab('show');
            $('#idseqH').val(head);
            $('#idctqH').val(idctq);
            //$('#DetailLabel1').text('Product : ' + $('#nameprod').val());
            $('#DetailLabel2').text('Remark  : ' + rem);
            $('#DetailLabel3').text('Row Hdr : ' + head);
            loadDetailRefresh(idctq, id, head);

        }

        function AddDetail() {
            $('#myModalAddDetail').modal('show');
            $('#myModalLabel3').text('Add Detail');
            $('#myModalLabel4').text($('#nameprod').val());            
            $('#myModalLabel5').text($('#DetailLabel3').text());
            $('#interval').val('');
            $('#dimabs').val('');
            $('#upperD').val('');
            $('#lowerD').val('');
            $('#cbtools').val('');
            $('#remD').val('');
            $('#btnAddDtl').show();
            $('#btnUpdateDtl').hide();
        }

        function addDetailModal() {
            var ctqH = $('#idctqH').val();
            var idp = $('#idprod').val();
            var rowh = $('#idseqH').val();
            var empObj = {
                idCtq1: ctqH,
                Id: idp,
                IdSeqH: rowh,
                dimabs: $('#dimabs').val(),
                upperdim: $('#upperD').val(),
                lowerdim: $('#lowerD').val(),
                measureID: $('#cbtools').val(),
                remarkD: $('#remD').val(),
                manualTime: $('#interval').val(),
            };

            $.ajax({
                url: urlPPIC + "/InsertSeqDetail",
                data: JSON.stringify(empObj),
                type: "POST",
                contentType: "application/json;charset=utf-8",
                beforeSend: function () { $(".loader").show(); },
                complete: function () { $(".loader").hide(); },
                dataType: "json",
                success: function (result) {
                    loadDetailRefresh(ctqH, idp, rowh);;
                    $('#myModalAddDetail').modal('hide');
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
        }

        function getDetail(intval, idctq, idprd, seqH, seqD, dimabs, up, low, tools, rem) {
            $('#myModalAddDetail').modal('show');
            $('#myModalLabel3').text('Update Detail');
            $('#myModalLabel5').text($('#DetailLabel3').val());
            $('#idctqH').val(idctq)
            $('#idseqH').val(seqH);
            $('#idseqD').val(seqD);
            $('#dimabs').val(dimabs);
            $('#upperD').val(up);
            $('#lowerD').val(low);
            $('#cbtools').val(tools);
            $('#remD').val(rem);
            $('#interval').val(intval);
            $('#btnUpdateDtl').show();
            $('#btnAddDtl').hide();
        
        }
        
        function editDetailModal() {
            var ctqH = $('#idctqH').val();
            var idp = $('#idprod').val();
            var rowh = $('#idseqH').val();
            var rowd = $('#idseqD').val();
            var empObj = {
                idCtq1: ctqH,
                Id: idp,
                IdSeqH: rowh,
                IdSeqD: rowd,
                dimabs: $('#dimabs').val(),
                upperdim: $('#upperD').val(),
                lowerdim: $('#lowerD').val(),
                measureID: $('#cbtools').val(),
                remarkD: $('#remD').val(),
                manualTime: $('#interval').val(),
            }; $.ajax({
                url: urlPPIC + "/UpdateseqDTL",
                data: JSON.stringify(empObj),
                type: "POST",
                contentType: "application/json;charset=utf-8",
                beforeSend: function () { $(".loader").show(); },
                complete: function () { $(".loader").hide(); },
                dataType: "json",
                success: function (result) {
                    $('#myModalAddDetail').modal('hide');
                    loadDetailRefresh(ctqH, idp, rowh);
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
        }


        function delDetail(idCtq, idprd, seqH, seqD) {
            var ans = confirm("Are you sure you want to delete this Record?");
            if (ans) {
                var empObj = {
                    idCtq1: idCtq, 
                    Id: idprd,
                    IdSeqH: seqH,
                    IdSeqD: seqD
                };
                $.ajax({
                    url: urlPPIC + "/DelseqDTL",
                    data: JSON.stringify(empObj),
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    beforeSend: function () { $(".loader").show(); },
                    complete: function () { $(".loader").hide(); },
                    dataType: "json",
                    success: function (result) {
                        loadDetailRefresh(idCtq, idprd, seqH);
                    },
                    error: function (errormessage) {
                        alert(errormessage.responseText);
                    }
                });
            }

        }

        function loadDetailRefresh(idctq1, id, head) {
            $('#tbodyDetailInfo').empty();
            $.getJSON(urlPPIC + "/ViewDetailSeq/", { idctq: idctq1, ID: id, seq: head },
            function (json) {
                var tr;
                var j = 1;
                for (var i = 0; i < json.length; i++) {
                    tr = $('<tr/>');
                    tr.append("<td>" + j + "</td>");
                    tr.append("<td><span class='pull-right'>" + json[i].dimabs + "</span></td>");
                    tr.append("<td><span class='pull-right'>" + json[i].upperdim + "</span></td>");
                    tr.append("<td><span class='pull-right'>" + json[i].lowerdim + "</span></td>");
                    tr.append("<td>" + json[i].measureName + "</td>");
                    tr.append("<td>" + json[i].remarkD + "</td>");
                    tr.append("<td><span class='pull-right'>" + json[i].manualTime + "</span></td>");
                    tr.append('<td><a href="javascript:void(0)" data-toggle="tooltip" title="Edit !" onclick="getDetail(' + json[i].manualTime + ',' + json[i].idCtq1 + ',' + json[i].Id + ',' + json[i].IdSeqH + ',' + json[i].IdSeqD + ',' + json[i].dimabs + ',' + json[i].upperdim + ',' + json[i].lowerdim + ',' + json[i].measureID + ',\'' + json[i].remarkD + '\')"><span class="glyphicon glyphicon-pencil"></span></a></td>');
                    tr.append('<td><a href="javascript:void(0)"  data-toggle="tooltip" title="Delete !" onclick="delDetail(' + json[i].idCtq1 + ',' + json[i].Id + ',' + json[i].IdSeqH + ',' + json[i].IdSeqD + ')"><span class="glyphicon glyphicon-trash"></span></a></td>');
                    $('#DetailInfo').append(tr);
                    j++;
                }
            });
        }

        function formatNumber(num) {
            return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,")

        }
        
        function loadTool() {
            $.ajax({
                url: urlPPIC + "/ViewMToolsAll",
                type: "GET",
                contentType: "application/json;charset=utf-8",
                dataType: "json",
                success: function (result) {
                    var html = '';
                    $.each(result, function (key, item) {
                        html += '<option value=' + item.ID + '>' + item.Name + '</option>';
                    });
                    $('#cbtools').html(html);
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            });
        }
       

    </script>


}